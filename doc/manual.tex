% Project:     DNS resolver
% @file        doc/documentation.tex
% @date        14.11.2023
% 
% @brief Documentation file
%
% @author Adam LiÅ¾iÄiar <xlizic00@stud.fit.vutbr.cz>

\documentclass[a4paper, 11pt]{article}

\usepackage[slovak]{babel}
\usepackage[utf8]{inputenc}
\usepackage[left=2cm, top=3cm, text={17cm, 24cm}]{geometry}
\usepackage{times}
\usepackage{verbatim}
\usepackage{enumitem}
\usepackage{graphicx}
\usepackage[unicode]{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    urlcolor=blue, 
    citecolor=blue
}

\begin{document}

	%%%%% TitulnÃ¡ strÃ¡nka %%%%%
	\begin{titlepage}
		\begin{center}
			\includegraphics[width=0.77\linewidth]{res/logo_FIT.pdf} \\

			\vspace{\stretch{0.382}}

			\scalebox{2}{\Huge{ManuÃ¡l}} \\
			\LARGE{DNS Resolver} \\
			\vspace{\stretch{0.618}}
		\end{center}

		\begin{minipage}[b]{0.4 \textwidth}
			\raggedright
			{\Large \today}
		\end{minipage}
		\hfill
		\begin{minipage}[b]{0.6 \textwidth}
			\raggedleft
			\Large
			Adam LiÅ¾iÄiar (xlizic00)\\
		\end{minipage}		
	\end{titlepage}

	%%%%% Obsah %%%%%
	\pagenumbering{roman}
	\setcounter{page}{1}
	\tableofcontents
	\clearpage

	\pagenumbering{arabic}
	\setcounter{page}{1}
	
	%%%%% Ãšvod %%%%%
	\section{Ãšvod}
	DNS (Domain Name System) resolver je~kÄ¾ÃºÄovou sÃºÄasÅ¥ou internetovej infraÅ¡truktÃºry, umoÅ¾ÅˆujÃºcou prevod Ä¾udom ÄitateÄ¾nÃ½ch domÃ©novÃ½ch mien (ako je~naprÃ­klad \texttt{www.fit.vut.cz}) na~IP adresy, ktorÃ©~ ~pouÅ¾Ã­vanÃ© pre~sieÅ¥ovÃº komunikÃ¡ciu. Tento dokument poskytuje prehÄ¾ad funkciÃ­ a~implementÃ¡cie programu \texttt{dns}, ktorÃ½ bol navrhnutÃ½ na~zasielanie dotazov na~DNS servery a~na~zobrazenie prijatÃ½ch odpovedÃ­ na~Å¡tandartnom vÃ½stupe.
	\subsection{Charakteristika DNS}
	DNS je~hierarchickÃ½ a~decentralizovanÃ½ systÃ©m, ktorÃ½~umoÅ¾Åˆuje uÅ¾Ã­vateÄ¾om na~internete nÃ¡jsÅ¥ webovÃ© strÃ¡nky a~inÃ© sluÅ¾by prostrednÃ­ctvom Ä¾udom ÄitateÄ¾nÃ½ch nÃ¡zvov, tzv.~domÃ©novÃ½ch mien. DNS servery sÃº~zodpovednÃ© za~prevod tÃ½chto nÃ¡zvov na~IP adresy (alebo naopak), ktorÃ© sÃº~nevyhnutnÃ© pre~nadviazanie sieÅ¥ovÃ©ho spojenia.
	\subsection{Funkcie a ÃºÄel programu DNS resolver}
	Program \texttt{dns} je nÃ¡stroj navrhnutÃ½ na~zasielanie dotazov na~DNS servery a~analÃ½zu prijatÃ½ch odpovedÃ­. UmoÅ¾Åˆuje pouÅ¾Ã­vateÄ¾om vykonÃ¡vaÅ¥ dotazy v~ÄitelnÃ© podobe a~poskytuje informÃ¡cie o~odpovediach od~DNS serverov. Priamo v~programe je~implementovanÃ© zostavenie a~odoslanie packetov, bez~potreby nÃ¡strojov. Program podporuje komunikÃ¡ciu pomocou UDP.	

	%%%%% Vytvorenie spustiteÄ¾nÃ©ho sÃºboru %%%%%
	\section{Vytvorenie spustiteÄ¾nÃ©ho sÃºboru a~automatizÃ¡cia Ãºloh}
	Prebieha pomocou Makefile na~automatizÃ¡ciu kompilÃ¡cie, testovania a~generovania dokumentÃ¡cie. 
	\begin{itemize}
		\item \texttt{make}: Kompiluje zdrojovÃ© sÃºbory projektu a~pomocou kompilÃ¡tora \texttt{g++} vytvÃ¡ra spustiteÄ¾nÃ½ sÃºbor \texttt{dns}.
		\item \texttt{make run}: SpustÃ­ skompilovanÃ½ program \texttt{dns} s~preddefinovanÃ½mi argumentmi, ÄÃ­m~demonÅ¡truje jeho funkÄnosÅ¥.
		\item \texttt{make test}: SpustÃ­ testovacie skripty definovanÃ© v adresÃ¡ri \texttt{tests}, ÄÃ­m overuje sprÃ¡vnosÅ¥ implementÃ¡cie programu.
		\item \texttt{make doc}: Generuje dokumentÃ¡ciu projektu vo~formÃ¡te PDF pomocou nÃ¡stroja \texttt{pdflatex}. VÅ¡etky sÃºborovÃ© operÃ¡cie sÃº~vykonÃ¡vanÃ© v~rÃ¡mci adresÃ¡ra \texttt{doc} a~vÃ½slednÃ¡ dokumentÃ¡cia je~presunutÃ¡ do~objektovÃ©ho adresÃ¡ra \texttt{obj} pre~udrÅ¾anie poriadku.
		\item \texttt{make clean}: OdstrÃ¡ni vÅ¡etky objektovÃ© a~doÄasnÃ© sÃºbory, ktorÃ© boli vytvorenÃ© poÄas kompilÃ¡cie, ÄÃ­m~udrÅ¾uje projektovÃ½ adresÃ¡r ÄistÃ½.
		\item \texttt{make cleanall}: RozÅ¡iruje funkcionalitu \texttt{clean} o~odstrÃ¡nenie spustiteÄ¾nÃ©ho sÃºboru \texttt{dns}, vygenerovanej dokumentÃ¡cie v~PDF a~vÅ¡etkÃ½ch vÃ½stupov z~testov.
	\end{itemize}
	\subsection{PoÅ¾iadavky na systÃ©m}
	Pre~ÃºspeÅ¡nÃº kompilÃ¡ciu a~fungovanie programu je~potrebnÃ© zabezpeÄiÅ¥, aby bol program spustenÃ½ v~operaÄnom systÃ©me Linux.
	
	%%%%% SpÃºÅ¡tanie programu %%%%%
	\section{SpÃºÅ¡tanie programu}
	PouÅ¾itie prÃ­kazu \texttt{dns} je~nasledovnÃ©:
	\begin{verbatim}
	dns [-h] [-r] [-x] [-6] -s server [-p port] adresa
	\end{verbatim}
	Poradie parametrov je~Ä¾ubovoÄ¾nÃ©, ak nie je nastavenÃ¡ premennÃ¡ prostredia $POSIXLY_CORRECT$. KaÅ¾dÃ½ parameter mÃ¡~Å¡pecifickÃ½ vÃ½znam:
	\begin{itemize}
		\item \texttt{-h}: VypÃ­Å¡e vysvetlenie pouÅ¾itia parametrov do~Å¡tandartnÃ©ho vÃ½stupu. PrÃ­klad vÃ½stupu je v prÃ­lohe \ref{subsection:res_A}
		\item \texttt{-r}: PoÅ¾adovanÃ¡ rekurzia (Recursion Desired = 1), inak bez~rekurzie.
		\item \texttt{-x}: ReverznÃ½ dotaz namiesto priameho.
		\item \texttt{-6}: Dotaz typu \texttt{AAAA} namiesto preddefinovanÃ©ho \texttt{A}.
		\item \texttt{-s server}: IP~adresa alebo~domÃ©novÃ© meno servera, kam sa mÃ¡~odoslaÅ¥ dotaz.
		\item \texttt{-p port}: ÄŒÃ­slo portu, na~ktorÃ½ sa mÃ¡~odoslaÅ¥ dotaz, preddefinovanÃ½ je~53.
		\item \texttt{adresa}: Adresa na zistenie.
	\end{itemize}
	
	\subsection{PrÃ­klady vÃ½stupov}
	\noindent OdpoveÄ na prÃ­kaz \texttt{./dns -r -s kazi.fit.vutbr.cz www.fit.vut.cz}
	\begin{verbatim}
		Authoritative: Yes, Recursive: Yes, Truncated: No
		Question section (1)
		  www.fit.vut.cz., A, IN
		Answer section (1)
		  www.fit.vut.cz., A, IN, 14400, 147.229.9.26
		Authority section (0)
		Additional section (0)
	\end{verbatim}

	\noindent OdpoveÄ na prÃ­kaz \texttt{./dns -r -6 -s kazi.fit.vutbr.cz www.fit.vut.cz}
	\begin{verbatim}
		Authoritative: Yes, Recursive: Yes, Truncated: No
		Question section (1)
		  www.fit.vut.cz., AAAA, IN
		Answer section (1)
		  www.fit.vut.cz., AAAA, IN, 14400, 2001:67c:1220:809::93e5:91a
		Authority section (0)
		Additional section (0)
	\end{verbatim}

	\noindent OdpoveÄ na prÃ­kaz \texttt{./dns -x -s kazi.fit.vutbr.cz 147.229.9.26}
	\begin{verbatim}
		Authoritative: Yes, Recursive: No, Truncated: No
		Question section (1)
		  26.9.229.147.in-addr.arpa., PTR, IN
		Answer section (1)
		  26.9.229.147.in-addr.arpa., PTR, IN, 14400, www.fit.vut.cz.
		Authority section (4)
		  9.229.147.in-addr.arpa., NS, IN, 14400, rhino.cis.vutbr.cz.
		  9.229.147.in-addr.arpa., NS, IN, 14400, gate.feec.vutbr.cz.
		  9.229.147.in-addr.arpa., NS, IN, 14400, guta.fit.vutbr.cz.
		  9.229.147.in-addr.arpa., NS, IN, 14400, kazi.fit.vutbr.cz.
		Additional section (0)
	\end{verbatim}
	
	%%%%% AnalÃ½za a interpretÃ¡cia vÃ½stupov %%%%%
	\section{AnalÃ½za a~interpretÃ¡cia vÃ½stupov}
	TÃ¡to sekcia rozoberÃ¡, Äo~moÅ¾no zistiÅ¥ vÄaka pouÅ¾itiu programu \texttt{dns}.
	\subsection{RekurzÃ­vne a~nerekurzÃ­vne dotazy}
	UmoÅ¾Åˆuje urÄiÅ¥, Äi sa~mÃ¡ vykonaÅ¥ rekurzÃ­vny (-r) alebo nerekurzÃ­vny dotaz. RekurzÃ­vne dotazy Å¾iadajÃº DNS server o~kompletnÃº odpoveÄ, zatiaÄ¾ Äo~nerekurzÃ­vne vrÃ¡tia len informÃ¡cie, ktorÃ© server uÅ¾ mÃ¡.
	\subsection{ReverznÃ© dotazy}
	Program umoÅ¾Åˆuje vykonÃ¡vaÅ¥ reverznÃ© dotazy (-x), vÄaka Äomu moÅ¾no zistiÅ¥ domÃ©novÃ© meno priradenÃ© k~erÄitej IP adrese.
	\subsection{Typy dotazov AAAA a~A}
	Poskytuje moÅ¾nosÅ¥ vykonÃ¡vaÅ¥ dotazy typu AAAA~(-6) pre~zÃ­skanie IPv6 adries alebo typu A pre~IPv4 adresy, Äo umoÅ¾Åˆuje flexibilitu v~zÃ­skavanÃ­ sieÅ¥ovÃ½ch informÃ¡ciÃ­.
	\subsection{VÃ½stupy a~ich interpretÃ¡cia}
	VÃ½stupy programu sÃº~prehÄ¾adnÃ© a informatÃ­vne, poskytujÃº podrobnÃ© Ãºdaje o~odpovediach DNS serverov. UmoÅ¾ÅˆujÃº zÃ­skaÅ¥ dÃ´leÅ¾itÃ© informÃ¡cie vrÃ¡tane autoritatÃ­vnosti odpovede, rekurzÃ­vnych vlastnostÃ­ a~detailov o~dotazovanej adrese.
	\subsection{VyuÅ¾itie vÃ½sledkov}
	Na~zÃ¡klade analÃ½zy vÃ½sledkov moÅ¾no zÃ­skaÅ¥ uÅ¾itoÄnÃ© informÃ¡cie pre~sieÅ¥ovÃº diagnostiku, administrÃ¡ciu a~plÃ¡novanie.

	%%%%% RieÅ¡enia problÃ©mov a chybovÃ© hlÃ¡Å¡ky %%%%%
	\section{RieÅ¡enia problÃ©mov a chybovÃ© hlÃ¡Å¡ky}
	//todo: BeÅ¾nÃ© problÃ©my a ich rieÅ¡enia.
	//todo: Vysvetlenie chybovÃ½ch hlÃ¡Å¡ok a kroky k ich odstrÃ¡neniu.
	
	%%%%% ArchitektÃºra programu %%%%%
	\section{ArchitektÃºra programu}
	//todo: StruÄnÃ½ popis kÄ¾ÃºÄovÃ½ch ÄastÃ­ programu.

	%%%%% Testovanie programu %%%%%
	\section{Testovanie programu}
	//todo: Postupy a nÃ¡stroje pre testovanie aplikÃ¡cie.
	//todo: PrÃ­klady testov a ich vÃ½znam.
	// testy su ok, a treba cakat kvoli zmene TTL.....Obsah databÃ¡ze DNS se z principÅ¯ mÄ›nÃ­ a mÅ¯Å¾e vypadat z rÅ¯znÃ½ch mÃ­st rÅ¯znÄ›. NapÅ™. doporuÄuji se serveru kazi.fit.vutbr.cz ptÃ¡t ze sÃ­tÄ› FIT. Do jinÃ½ch sÃ­tÃ­ mohou bÃ½t odpovÄ›di jinÃ©. UkÃ¡zkovÃ© zÃ¡znamy jsou mimo mou kontrolu a mohou se nepÅ™edvÃ­datelnÄ› mÄ›nit, v prÅ¯bÄ›hu Å™eÅ¡enÃ­ projektu mohou bÃ½t zruÅ¡enÃ¡, doÄasnÄ› nedostupnÃ¡, novÄ› pÅ™esmÄ›rovanÃ¡ jinam apod.
	
	ReferenÄnÃ­ prostÅ™edÃ­ pro pÅ™eklad a testovÃ¡nÃ­

	Program by mÄ›l bÃ½t pÅ™enositelnÃ½. ReferenÄnÃ­ prostÅ™edÃ­ pro pÅ™eklad budou servery eva.fit.vutbr.cz a merlin.fit.vutbr.cz (program musÃ­ bÃ½t pÅ™eloÅ¾itelnÃ½ a funkÄnÃ­ na obou systÃ©mech). VlastnÃ­ testovÃ¡nÃ­ mÅ¯Å¾e probÃ­hat na jinÃ©m poÄÃ­taÄi s nainstalovanÃ½m OS GNU/Linux, Äi FreeBSD, vÄetnÄ› jinÃ½ch architektur neÅ¾ Intel/AMD, jinÃ½ch distribucÃ­, jinÃ½ch verzÃ­ knihoven apod. Pokud vyÅ¾adujete minimÃ¡lnÃ­ verzi knihovny (dostupnÃ© na serveru merlin a eva), jasnÄ› tuto skuteÄnost oznaÄte v dokumentaci a README.

	%error testy testuju, ci na vystupe je chybovy vystup "[31m[0m"

	%%%%% RozÅ¡Ã­renia %%%%%
	\section{RozÅ¡Ã­renia}
	//todo: AkÃ© rozÅ¡Ã­renia mÃ¡ program? (podpora viac vecÃ­, chybovÃ© kÃ³dy, chybovÃ© hlÃ¡Å¡ky,...)
	// Errcodes
	// ZadÃ¡nÃ­ nespecifikuje, kterÃ© typy RDATA bychom mÄ›li bÃ½t schopni zpracovÃ¡vat. Existuje vÃ­ce neÅ¾ 16 typÅ¯, ale zadÃ¡nÃ­ se zmiÅˆuje pouze o CNAME, A, AAAA. MÄ›l by je program umÄ›t zpracovat vÅ¡echny, nebo jen tyto tÅ™i?:::::	Tato funkcionalita je vyÅ¾adovanÃ¡ v zadÃ¡nÃ­. ZpracovÃ¡nÃ­ dalÅ¡Ã­ch, vÃ¡mi uvedenÃ½ch i typÅ¯ zÃ¡znamÅ¯ z jinÃ½ch RFC, lze vnÃ­mat jako funkcionalitu zÃ¡kladnÃ­ zadÃ¡nÃ­ rozÅ¡iÅ™ujÃ­cÃ­. PakliÅ¾e se rozhodnete implementovat funkcionalitu nad rÃ¡mec zadÃ¡nÃ­, jasnÄ› toto rozÅ¡Ã­Å™enÃ­ oznaÄte v souboru README a dokumentaci. VÃ¡mi implementovanÃ© rozÅ¡Ã­Å™enÃ­ Å™Ã¡dnÄ› dokumenujte. VaÅ¡e rozhodnutÃ­ ve fÃ¡zi nÃ¡vrhu a implementace Å™Ã¡dnÄ› dokumentujte a vysvÄ›tlete v dokumentaci.
	je tam kontrola na format vstupu argumentov
	// man stranka v src/man/dns.1


	%%%%% Referencie %%%%%
	\section{Referencie}
	//todo: referencie
	https://datatracker.ietf.org/doc/html/rfc1035
	https://datatracker.ietf.org/doc/html/rfc3596

	%%%%% PrÃ­lohy %%%%%
	\clearpage
	\section{PrÃ­lohy}
	
	\subsection{VÃ½pis \texttt{./dns -h} na~Å¡tandartnom vÃ½stupe}
	\label{subsection:res_A}

	\begin{figure}[ht]
		\centering
		\includegraphics[width=1 \linewidth]{res/A.png}

		\caption{PrÃ­klad vÃ½stupu \texttt{./dns -h} na~Å¡tandartnom vÃ½stupe. PrÃ­klad bol realizovanÃ½ na~serveri \mbox{merlin.fit.vutbr.cz}}
	\end{figure}

\end{document}
